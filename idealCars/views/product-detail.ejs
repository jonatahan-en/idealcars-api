<%- include("header.ejs") %>
<link rel="stylesheet" href="/style/product-detail.css">
<main class="card-container">
    <section class="detail-card">
        <h2><%= product.name %> - <%= product.model %></h2>
        <p>🎨 <%= __('home.product.color') %>: <%= product.color %></p>
        <p>📅 <%= __('home.product.year') %>: <%= product.year %></p>
        <p>💶 <%= __('home.product.price') %>: <%= typeof product.price !== 'undefined' ? product.price.toLocaleString('es-ES', { style: 'currency', currency: 'EUR' }) : '' %></p>
        <p>🏁 <%= __('home.product.kilometer') %>: <%= typeof product.kilometer !== 'undefined' ? product.kilometer.toLocaleString('es-ES') : '' %> km</p>

        <% if (product.images && product.images.length > 0) { %>
        <div class="carousel-container" id="carousel">
            <% product.images.forEach((image) => { %>
            <img src="/imagenes/<%= image %>" alt="<%= product.name %>">
            <% }) %>
            <button class="carousel-btn prev" onclick="moveSlide(-1)">&#10094;</button>
            <button class="carousel-btn next" onclick="moveSlide(1)">&#10095;</button>
        </div>
        <% } else { %>
        <p>No hay imágenes disponibles</p>
        <% } %>

        <a href="/chat/<%= product._id %>" class="contact-btn">
        <i class="bi bi-chat-dots"></i> Ir al chat
        </a>
        <a href="/" class="home-btn">
        <%= __('common.home') %>
        </a>
    </section>
</main>

<script>
    let currentIndex = 0;

    function moveSlide(direction) {
        const slides = document.querySelectorAll('#carousel img');
        const totalSlides = slides.length;

        slides[currentIndex].style.display = 'none';
        currentIndex = (currentIndex + direction + totalSlides) % totalSlides;
        slides[currentIndex].style.display = 'block';
    }

    document.addEventListener('DOMContentLoaded', () => {
        const slides = document.querySelectorAll('#carousel img');
        slides.forEach(slide => slide.style.display = 'none');
        if (slides.length > 0) {
        slides[0].style.display = 'block';
        }
    });
</script>
<%- include("footer.ejs") %>
