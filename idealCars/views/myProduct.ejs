<%- include("header.ejs") %>
<main class="container py-5 main-bg-container">
    <h2 class="mb-3" style="font-size:1.5rem; font-weight:600;">🚗 <%= __('navigation.myProducts') %></h2>
    <div class="row row-cols-1 row-cols-md-4 g-4"> <%# Usa row y col-md-4 para la cuadrícula %>
        <% products.forEach(product => { %>
            <div class="col"> <%# Cada producto en una columna %>
                <div class="ProductCard h-100 d-flex flex-column"> <%# Usa ProductCard y asegura altura completa %>
                    <% if (product.images && product.images.length > 0) { %>
                        <img src="/imagenes/<%= product.images[0] %>" class="card-img-top product-grid-img" alt="<%= product.name %>"> <%# Añadida clase product-grid-img %>
                    <% } else { %>
                        <img src="https://placehold.co/600x400?text=<%= product.name %>" class="card-img-top product-grid-img" alt="<%= product.name %>"> <%# Añadida clase product-grid-img %>
                    <% } %>
                    <div class="card-body d-flex flex-column"> <%# Cuerpo de la tarjeta %>
                        <h5 class="card-title"><%= product.name %> - <%= product.model %></h5>
                        <p class="card-text mb-1"><%= __('home.product.color') %>: <%= product.color %></p>
                        <p class="card-text mb-1"><%= __('home.product.year') %>: <%= product.year %></p>
                        <p class="card-text mb-1"><%= __('home.product.price') %>: <%= typeof product.price !== 'undefined' ? product.price.toLocaleString('es-ES', { style: 'currency', currency: 'EUR' }) : '' %></p>
                        <p class="card-text mb-2"><%= __('home.product.kilometer') %>: <%= typeof product.kilometer !== 'undefined' ? product.kilometer.toLocaleString('es-ES') : '' %> km</p>
                    </div>
                    <div class="mt-auto p-2"> <%# Contenedor para botones al final %>
                        <!-- Botón para editar el producto -->
                        <a href="/myproducts/edit/<%= product._id %>" class="btn btn-warning btn-sm mb-1 w-100"> <%# btn-sm y w-100 %>
                            <i class="bi bi-pencil"></i> Editar
                        </a>
                        <!-- Botón para borrar el producto -->
                        <form action="/myproducts/delete/<%= product._id %>?_method=DELETE" method="POST" style="display: block;" onsubmit="return confirm('¿Estás seguro de que deseas borrar este producto?');"> <%# display: block %>
                            <button type="submit" class="btn btn-danger btn-sm w-100"> <%# btn-sm y w-100 %>
                                <i class="bi bi-trash3"></i> Borrar
                            </button>
                        </form>
                    </div>
                </div>
            </div>
        <% }) %>
    </div>
    <div class="pagination mt-4">
        <% if (skip > 0) { %>
            <a href="?skip=<%= skip - limit %>&limit=<%= limit %>" class="btn btn-secondary">Anterior</a>
        <% } %>
        <% if (skip + limit < count) { %>
        <a href="?skip=<%= skip + limit %>&limit=<%= limit %>" class="btn btn-secondary ms-2">Siguiente</a>
        <% } %>
    </div>
</main>
<%- include("footer.ejs") %>